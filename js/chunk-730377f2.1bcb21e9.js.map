{"version":3,"sources":["webpack:///./node_modules/@babel/runtime/helpers/esm/typeof.js","webpack:///./src/utils/resetForm.js","webpack:///./src/views/Login.vue","webpack:///./src/views/Login.vue?50b2","webpack:///./node_modules/core-js/modules/es.object.keys.js","webpack:///./node_modules/core-js/modules/es.array.map.js"],"names":["_typeof","obj","Symbol","iterator","constructor","prototype","resetForm","target","reset","Object","keys","map","key","Array","element","undefined","class","_createElementVNode","_createElementBlock","_hoisted_2","_createVNode","_component_el_input","$setup","account","$event","type","placeholder","data-space-bottom","_hoisted_3","password","_hoisted_4","otp","_toDisplayString","OTP","_component_el_button","onClick","name","setup","store","useStore","router","useRouter","loginForm","reactive","init","removeLogin","callOtp","onMounted","data","callApi","getOtp","res","Data","getPermission","id","state","userModules","userStatus","MemberID","getAdminPermissions","commit","Permission","catch","ElMessage","showClose","message","hanleRouterChange","push","checkLogin","options","confirmOtp","login","hanleLogin","__exports__","render","$","toObject","nativeKeys","fails","FAILS_ON_PRIMITIVES","stat","forced","it","$map","arrayMethodHasSpeciesSupport","HAS_SPECIES_SUPPORT","proto","callbackfn","this","arguments","length"],"mappings":"gNAAe,SAASA,EAAQC,GAG9B,OAAOD,EAAU,mBAAqBE,QAAU,iBAAmBA,OAAOC,SAAW,SAAUF,GAC7F,cAAcA,GACZ,SAAUA,GACZ,OAAOA,GAAO,mBAAqBC,QAAUD,EAAIG,cAAgBF,QAAUD,IAAQC,OAAOG,UAAY,gBAAkBJ,GACvHD,EAAQC,G,wBCPAK,EAAY,SAACC,GACxB,IAAMC,EAAQ,SAARA,EAASP,GACbQ,OAAOC,KAAKT,GAAKU,KAAI,SAACC,GACpB,GAAIX,EAAIW,KAASH,OAAOR,EAAIW,IAK1B,OAJAJ,EAAMP,EAAIW,SACNX,EAAIW,aAAgBC,QACtBZ,EAAIW,GAAO,KAKb,IAAME,EAAUb,EAAIW,GACpB,OAAQ,EAAOE,IACb,IAAK,SACHb,EAAIW,GAAO,GACX,MACF,IAAK,SACHX,EAAIW,GAAO,EACX,MACF,IAAK,SACHX,EAAIW,GAAOE,aAAmBD,MAAQ,GAAK,GAC3C,MACF,IAAK,UACHZ,EAAIW,IAAO,EACX,MACF,QACEX,EAAIW,QAAOG,EACX,WAKVP,EAAMD,K,4DC/BDS,MAAM,sB,EACTC,eAAY,SAAT,SAAK,G,EAERA,eAAS,SAAN,MAAE,G,EAELA,eAAU,SAAP,OAAG,G,GACDD,MAAM,kB,GAEJA,MAAM,O,GAERA,MAAM,yB,iBACuC,M,iBAChB,M,+GAZpCE,eAcM,MAdN,EAcM,CAbJC,EACAC,eAAmGC,EAAA,C,WAAhFC,YAAUC,Q,qDAAVD,YAAUC,QAAOC,IAAEC,KAAK,OAAOC,YAAY,QAAQC,oBAAkB,UAAxF,uBACAC,EACAR,eAAwGC,EAAA,C,WAArFC,YAAUO,S,qDAAVP,YAAUO,SAAQL,IAAEC,KAAK,WAAWC,YAAY,QAAQC,oBAAkB,UAA7F,uBACAG,EACAb,eAGM,MAHN,EAGM,CAFJG,eAAyEC,EAAA,C,WAAtDC,YAAUS,I,qDAAVT,YAAUS,IAAGP,IAAEC,KAAK,OAAOE,oBAAkB,QAAhE,uBACAV,eAAoC,MAApC,EAAoCe,eAAhBV,MAAIW,KAAG,KAE7BhB,eAGM,MAHN,EAGM,CAFJG,eAA8Dc,EAAA,CAAnDT,KAAK,UAAWU,QAAK,+BAAEb,kBAAlC,C,yBAAgD,iBAAE,O,MAClDF,eAA8Cc,EAAA,CAAlCC,QAAOb,eAAW,C,yBAAE,iBAAE,O,KAAlC,mB,oGAcS,GACbc,KAAM,QACNC,MAFa,WAGX,IAAMC,EAAQC,iBACRC,EAASC,iBACTC,EAAYC,eAAS,CACzBpB,QAAS,GACTM,SAAU,GACVE,IAAK,KAEHA,EAAMY,eAAS,CAAEV,IAAK,KAEpBW,EAAO,WACXC,IACAC,KAGIA,EAAUC,eAAS,wCAAC,oGAClBC,EAAO,GACbC,eAAQC,OAAQF,GAAM,SAACG,GACrBpB,EAAIE,IAAMkB,EAAIH,KAAKI,KAAKnB,OAHF,4CAOpBoB,EAAY,yDAAI,6GACdC,EAAKhB,EAAMiB,MAAMC,YAAYC,WAAWH,GACxCN,EAAO,CAAEU,SAAUJ,GAFL,SAGdL,eAAQU,OAAqBX,GAAM,SAACG,GACxCb,EAAMsB,OAAO,kCAAmCT,EAAIH,KAAKI,KAAKS,eAC7DC,OAAM,WACPC,eAAU,CACRC,WAAW,EACXC,QAAS,UACTxC,KAAM,UAERmB,OAXkB,2CAAJ,qDAeZsB,EAAgB,yDAAI,8GAClBb,IADkB,uBAElBb,EAAO2B,KAAK,CAAE/B,KAAM,SAFF,2CAAJ,qDAKhBgC,EAAa,SAACC,GAClB,IAAQ9C,EAAuC8C,EAAvC9C,QAASM,EAA8BwC,EAA9BxC,SAAUE,EAAoBsC,EAApBtC,IAAKuC,EAAeD,EAAfC,WAC1BC,EAAoB,KAAZhD,GAA+B,KAAbM,GAA2B,KAARE,GAAcA,IAAQuC,EACzE,OAAOC,GAGHC,EAAa,WACbJ,EAAW,CAAE7C,QAASmB,EAAUnB,QAASM,SAAUa,EAAUb,SAAUE,IAAKW,EAAUX,IAAKuC,WAAYvC,EAAIE,MAC7GgB,eAAQsB,OAAO7B,GAAW,SAACS,GACzBb,EAAMsB,OAAO,6BAA8BT,EAAIH,KAAKI,MACpDc,QAGFH,eAAU,CACRC,WAAW,EACXC,QAAS,eACTxC,KAAM,UAERmB,MAGEC,EAAc,WAClBvC,eAAUoC,IAEZ,MAAO,CACLI,UACAf,MACAW,YACA8B,aACA3B,cACAD,U,qBChGN,MAAM6B,EAA2B,IAAgB,EAAQ,CAAC,CAAC,SAASC,KAErD,gB,qBCPf,IAAIC,EAAI,EAAQ,QACZC,EAAW,EAAQ,QACnBC,EAAa,EAAQ,QACrBC,EAAQ,EAAQ,QAEhBC,EAAsBD,GAAM,WAAcD,EAAW,MAIzDF,EAAE,CAAEpE,OAAQ,SAAUyE,MAAM,EAAMC,OAAQF,GAAuB,CAC/DrE,KAAM,SAAcwE,GAClB,OAAOL,EAAWD,EAASM,Q,kCCV/B,IAAIP,EAAI,EAAQ,QACZQ,EAAO,EAAQ,QAAgCxE,IAC/CyE,EAA+B,EAAQ,QAEvCC,EAAsBD,EAA6B,OAKvDT,EAAE,CAAEpE,OAAQ,QAAS+E,OAAO,EAAML,QAASI,GAAuB,CAChE1E,IAAK,SAAa4E,GAChB,OAAOJ,EAAKK,KAAMD,EAAYE,UAAUC,OAAS,EAAID,UAAU,QAAK1E","file":"js/chunk-730377f2.1bcb21e9.js","sourcesContent":["export default function _typeof(obj) {\n  \"@babel/helpers - typeof\";\n\n  return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (obj) {\n    return typeof obj;\n  } : function (obj) {\n    return obj && \"function\" == typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n  }, _typeof(obj);\n}","export const resetForm = (target) => {\n  const reset = (obj) => {\n    Object.keys(obj).map((key) => {\n      if (obj[key] === Object(obj[key])) {\n        reset(obj[key])\n        if (obj[key] instanceof Array) {\n          obj[key] = []\n        }\n        return\n      } else {\n        // 保留型別\n        const element = obj[key]\n        switch (typeof element) {\n          case 'string':\n            obj[key] = ''\n            break\n          case 'number':\n            obj[key] = 0\n            break\n          case 'object':\n            obj[key] = element instanceof Array ? [] : {}\n            break\n          case 'boolean':\n            obj[key] = false\n            break\n          default:\n            obj[key] = undefined\n            break\n        }\n      }\n    })\n  }\n  reset(target)\n}\n","<template>\n  <div class=\"login row vertical\">\n    <p>使用者帳號</p>\n    <el-input v-model=\"loginForm.account\" type=\"text\" placeholder=\"請輸入帳號\" data-space-bottom=\"0.5rem\" />\n    <p>密碼</p>\n    <el-input v-model=\"loginForm.password\" type=\"password\" placeholder=\"請輸入密碼\" data-space-bottom=\"0.5rem\" />\n    <p>驗證碼</p>\n    <div class=\"row horizontal\">\n      <el-input v-model=\"loginForm.otp\" type=\"text\" data-space-bottom=\"1rem\" />\n      <div class=\"otp\">{{ otp.OTP }}</div>\n    </div>\n    <div class=\"row horizontal center\">\n      <el-button type=\"primary\" @click=\"hanleLogin()\">登入</el-button>\n      <el-button @click=\"removeLogin\">清除</el-button>\n    </div>\n  </div>\n</template>\n\n<script>\nimport { reactive, onMounted } from 'vue'\nimport { useRouter } from 'vue-router'\nimport { getOtp, login, getAdminPermissions } from '@/service/api'\nimport { useStore } from 'vuex'\nimport { ElMessage } from 'element-plus'\nimport { callApi } from '@/utils/callApi'\nimport { resetForm } from '@/utils/resetForm'\n\nexport default {\n  name: 'Login',\n  setup() {\n    const store = useStore()\n    const router = useRouter()\n    const loginForm = reactive({\n      account: '',\n      password: '',\n      otp: ''\n    })\n    let otp = reactive({ OTP: '' })\n    // 初始化\n    const init = () => {\n      removeLogin()\n      callOtp()\n    }\n    //取得otp\n    const callOtp = onMounted(async () => {\n      const data = ''\n      callApi(getOtp, data, (res) => {\n        otp.OTP = res.data.Data.OTP\n      })\n    })\n    //取得當前管理員的權限列表並更新store裡的資訊\n    const getPermission = async () => {\n      const id = store.state.userModules.userStatus.id\n      const data = { MemberID: id }\n      await callApi(getAdminPermissions, data, (res) => {\n        store.commit('userModules/SET_USERPERMISSIONS', res.data.Data.Permission)\n      }).catch(() => {\n        ElMessage({\n          showClose: true,\n          message: '沒有使用權限！',\n          type: 'error'\n        })\n        init()\n      })\n    }\n    //先取得權限表後才轉換路由\n    const hanleRouterChange = async () => {\n      await getPermission()\n      await router.push({ name: 'Home' })\n    }\n    // 檢查登入條件是否符合\n    const checkLogin = (options) => {\n      const { account, password, otp, confirmOtp } = options\n      const login = account !== '' && password !== '' && otp !== '' && otp === confirmOtp\n      return login\n    }\n    // 登入\n    const hanleLogin = () => {\n      if (checkLogin({ account: loginForm.account, password: loginForm.password, otp: loginForm.otp, confirmOtp: otp.OTP })) {\n        callApi(login, loginForm, (res) => {\n          store.commit('userModules/SET_USERSTATUS', res.data.Data)\n          hanleRouterChange()\n        })\n      } else {\n        ElMessage({\n          showClose: true,\n          message: '欄位不可為空或輸入有誤！',\n          type: 'error'\n        })\n        init()\n      }\n    }\n    const removeLogin = () => {\n      resetForm(loginForm)\n    }\n    return {\n      callOtp,\n      otp,\n      loginForm,\n      hanleLogin,\n      removeLogin,\n      init\n    }\n  }\n}\n</script>\n","import { render } from \"./Login.vue?vue&type=template&id=dca8a396\"\nimport script from \"./Login.vue?vue&type=script&lang=js\"\nexport * from \"./Login.vue?vue&type=script&lang=js\"\n\nimport exportComponent from \"/Users/risu_ann/Documents/web/dessert_backstage/node_modules/vue-loader-v16/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__","var $ = require('../internals/export');\nvar toObject = require('../internals/to-object');\nvar nativeKeys = require('../internals/object-keys');\nvar fails = require('../internals/fails');\n\nvar FAILS_ON_PRIMITIVES = fails(function () { nativeKeys(1); });\n\n// `Object.keys` method\n// https://tc39.es/ecma262/#sec-object.keys\n$({ target: 'Object', stat: true, forced: FAILS_ON_PRIMITIVES }, {\n  keys: function keys(it) {\n    return nativeKeys(toObject(it));\n  }\n});\n","'use strict';\nvar $ = require('../internals/export');\nvar $map = require('../internals/array-iteration').map;\nvar arrayMethodHasSpeciesSupport = require('../internals/array-method-has-species-support');\n\nvar HAS_SPECIES_SUPPORT = arrayMethodHasSpeciesSupport('map');\n\n// `Array.prototype.map` method\n// https://tc39.es/ecma262/#sec-array.prototype.map\n// with adding support of @@species\n$({ target: 'Array', proto: true, forced: !HAS_SPECIES_SUPPORT }, {\n  map: function map(callbackfn /* , thisArg */) {\n    return $map(this, callbackfn, arguments.length > 1 ? arguments[1] : undefined);\n  }\n});\n"],"sourceRoot":""}